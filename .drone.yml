---
kind: pipeline
name: default

steps:
- name: test
  image: python:alpine
  commands:
  - apk add --no-cache g++
  - pip3 install platformio
  - platformio update
  - pio test -e native

- name: build
  image: debian:buster-slim
  commands:
  - apt-get update
  - apt-get -f --no-install-recommends install g++ python3-pip
  - pip3 install platformio
  - platformio update
  - platformio platform install espressif8266
  - "[ ! -e include/WifiParams.h ] && cp ci/WifiParams.h include/"
  - pio run -e d1_mini

- name: wait
  image: python:alpine
  depends_on:
    - test
    - build
---
kind: signature
hmac: ea0ec7bb127725dba984e5f6652dbe6df6f943cc15f018ed587135e80dc96f9c

...
